<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Johan Hidding" />
  <title>Elemental Cellular Automata</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="pandoc-bootstrap-template/template.css" />
</head>
<body>
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">Elemental Cellular Automata</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">Johan Hidding</p></li>
                            </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div id="TOC" class="span3">
        <div class="well toc">
        <ul>
          <li class="nav-header">Table of Contents</li>
        </ul>
        <ul>
        <li><a href="#the-universe">The universe</a><ul>
        <li><a href="#printing-output">Printing output</a></li>
        <li><a href="#app">App</a><ul>
        <li><a href="#arguments">Arguments</a></li>
        <li><a href="#main-function">Main function</a></li>
        </ul></li>
        </ul></li>
        </ul>
        </div>
      </div>
            <div class="span9">
      <h1 id="the-universe">The universe</h1>
<p>The universe is a circular space with <span class="math inline"><em>N</em></span> bits. It started out completely random</p>
<div class="annotated-code">
<p><span><em>«and-the-earth-was-without-form-and-void»=</em></span></p>
<div class="sourceCode" id="and-the-earth-was-without-form-and-void"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="and-the-earth-was-without-form-and-void-1"><a href="#and-the-earth-was-without-form-and-void-1"></a>universe = rand(<span class="dt">Bool</span>, N)</span></code></pre></div>
</div>
<p>Then there was connection: each bit has a neighbourhood: itself and its two direct neighbours. There are <span class="math inline">2<sup>3</sup> = 8</span> different possible neighbourhoods.</p>
<div class="annotated-code">
<p><span><em>«eca»=</em></span></p>
<div class="sourceCode" id="eca"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="eca-1"><a href="#eca-1"></a><span class="kw">function</span> neighbourhood(u)</span>
<span id="eca-2"><a href="#eca-2"></a>    <span class="kw">return</span> circshift(u, <span class="fl">1</span>) * <span class="fl">4</span> .+ u * <span class="fl">2</span> .+ circshift(u, -<span class="fl">1</span>) .+ <span class="fl">1</span></span>
<span id="eca-3"><a href="#eca-3"></a><span class="kw">end</span></span></code></pre></div>
</div>
<p>Then there was time: each bit would evolve by a rule based on its neighbourhood. There are <span class="math inline">2<sup>8</sup> = 256</span> possible rules.</p>
<div class="annotated-code">
<p><span><em>«eca»+</em></span></p>
<div class="sourceCode" id="eca"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="eca-1"><a href="#eca-1"></a><span class="kw">function</span> rule(p)</span>
<span id="eca-2"><a href="#eca-2"></a>    rule_map = convert(<span class="dt">Array</span>{<span class="dt">Bool</span>}, digits(p, base=<span class="fl">2</span>, pad=<span class="fl">8</span>))</span>
<span id="eca-3"><a href="#eca-3"></a>    <span class="kw">return</span> (u) -&gt; rule_map[neighbourhood(u)]</span>
<span id="eca-4"><a href="#eca-4"></a><span class="kw">end</span></span></code></pre></div>
</div>
<p>And using the rule we can evolve.</p>
<div class="annotated-code">
<p><span><em>«eca»+</em></span></p>
<div class="sourceCode" id="eca"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="eca-1"><a href="#eca-1"></a><span class="kw">function</span> evolve(rule, u)</span>
<span id="eca-2"><a href="#eca-2"></a>    <span class="kw">return</span> Channel() <span class="kw">do</span> ch</span>
<span id="eca-3"><a href="#eca-3"></a>        put!(ch, u)</span>
<span id="eca-4"><a href="#eca-4"></a>        <span class="kw">while</span> true</span>
<span id="eca-5"><a href="#eca-5"></a>            u = rule(u)</span>
<span id="eca-6"><a href="#eca-6"></a>            put!(ch, u)</span>
<span id="eca-7"><a href="#eca-7"></a>        <span class="kw">end</span></span>
<span id="eca-8"><a href="#eca-8"></a>    <span class="kw">end</span></span>
<span id="eca-9"><a href="#eca-9"></a><span class="kw">end</span></span></code></pre></div>
</div>
<p>And life was born in Figure <a href="#fig:rule30">1</a>.</p>
<div id="fig:rule30" class="fignos">
<figure>
<img src="plot.png" alt="" /><figcaption><span>Figure 1:</span> Rule 30</figcaption>
</figure>
</div>
<h2 id="printing-output">Printing output</h2>
<div class="annotated-code">
<p><span><em>«eca»+</em></span></p>
<div class="sourceCode" id="eca"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="eca-1"><a href="#eca-1"></a><span class="kw">function</span> print_matrix(x)</span>
<span id="eca-2"><a href="#eca-2"></a>    println(join([join((string ∘ <span class="dt">Int64</span>).(y), <span class="st">&quot; &quot;</span>)</span>
<span id="eca-3"><a href="#eca-3"></a>                  <span class="kw">for</span> y <span class="kw">in</span> eachcol(x)], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="eca-4"><a href="#eca-4"></a><span class="kw">end</span></span></code></pre></div>
</div>
<h2 id="app">App</h2>
<p>To parse command line arguments in Julia we start with the following skeleton:</p>
<div class="annotated-code">
<p><span><em>«src/ca.jl»=</em></span></p>
<div class="sourceCode" id="cb1" data-file="src/ca.jl"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1"></a>using ArgParse</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>&lt;&lt;eca&gt;&gt;</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">function</span> parse_command_line()</span>
<span id="cb1-6"><a href="#cb1-6"></a>    s = ArgParseSettings()</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>    @add_arg_table! s <span class="kw">begin</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>        &lt;&lt;command-line-arguments&gt;&gt;</span>
<span id="cb1-10"><a href="#cb1-10"></a>    <span class="kw">end</span></span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a>    <span class="kw">return</span> parse_args(s)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">end</span></span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="kw">function</span> main()</span>
<span id="cb1-16"><a href="#cb1-16"></a>    args = parse_command_line()</span>
<span id="cb1-17"><a href="#cb1-17"></a>    &lt;&lt;main&gt;&gt;</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="kw">end</span></span>
<span id="cb1-19"><a href="#cb1-19"></a></span>
<span id="cb1-20"><a href="#cb1-20"></a>main()</span></code></pre></div>
</div>
<h3 id="arguments">Arguments</h3>
<h4 id="size-of-the-universe">Size of the universe</h4>
<div class="annotated-code">
<p><span><em>«command-line-arguments»=</em></span></p>
<div class="sourceCode" id="command-line-arguments"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="command-line-arguments-1"><a href="#command-line-arguments-1"></a><span class="st">&quot;--size&quot;</span>, <span class="st">&quot;-s&quot;</span></span>
<span id="command-line-arguments-2"><a href="#command-line-arguments-2"></a>    help = <span class="st">&quot;size of universe&quot;</span></span>
<span id="command-line-arguments-3"><a href="#command-line-arguments-3"></a>    default = <span class="st">&quot;512&quot;</span></span></code></pre></div>
</div>
<h4 id="age-of-the-universe">Age of the universe</h4>
<div class="annotated-code">
<p><span><em>«command-line-arguments»+</em></span></p>
<div class="sourceCode" id="command-line-arguments"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="command-line-arguments-1"><a href="#command-line-arguments-1"></a><span class="st">&quot;--gen&quot;</span>, <span class="st">&quot;-g&quot;</span></span>
<span id="command-line-arguments-2"><a href="#command-line-arguments-2"></a>    help = <span class="st">&quot;number of generations&quot;</span></span>
<span id="command-line-arguments-3"><a href="#command-line-arguments-3"></a>    default = <span class="st">&quot;512&quot;</span></span></code></pre></div>
</div>
<h4 id="rule">Rule</h4>
<div class="annotated-code">
<p><span><em>«command-line-arguments»+</em></span></p>
<div class="sourceCode" id="command-line-arguments"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="command-line-arguments-1"><a href="#command-line-arguments-1"></a><span class="st">&quot;--rule&quot;</span>, <span class="st">&quot;-r&quot;</span></span>
<span id="command-line-arguments-2"><a href="#command-line-arguments-2"></a>    help = <span class="st">&quot;rule number&quot;</span></span>
<span id="command-line-arguments-3"><a href="#command-line-arguments-3"></a>    default = <span class="st">&quot;30&quot;</span></span></code></pre></div>
</div>
<h3 id="main-function">Main function</h3>
<div class="annotated-code">
<p><span><em>«main»=</em></span></p>
<div class="sourceCode" id="main"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="main-1"><a href="#main-1"></a>N = parse(<span class="dt">Int64</span>, args[<span class="st">&quot;size&quot;</span>])</span>
<span id="main-2"><a href="#main-2"></a>T = parse(<span class="dt">Int64</span>, args[<span class="st">&quot;gen&quot;</span>])</span>
<span id="main-3"><a href="#main-3"></a>p = parse(<span class="dt">Int64</span>, args[<span class="st">&quot;rule&quot;</span>])</span>
<span id="main-4"><a href="#main-4"></a></span>
<span id="main-5"><a href="#main-5"></a>&lt;&lt;and-the-earth-was-without-form-and-void&gt;&gt;</span>
<span id="main-6"><a href="#main-6"></a>history = Iterators.take(evolve(rule(p), universe), T)</span>
<span id="main-7"><a href="#main-7"></a>print_matrix(hcat(collect(history)...))</span></code></pre></div>
</div>
            </div>
    </div>
  </div>
</body>
</html>
